# 性能优化

## 1、逻辑层和视图层分离：非h5端通信有折损

原理....

## 2、建议

1. 避免使用大图、多张大图集成在一个页面

2. 优化数据更新：定义在data中的数据每次发生变化都会通知视图层更新，如果不是视图层需要的变量可以不同定义在data里

3. 列表数据差：应该封装成单个item组件，这样单个组件数据发生改变，就不会发生整体刷新的

4. 长列表建议使用分页，这样性能更好，想想也知道

5. app端长列表情况最好使用`list组件`，有自动渲染回收机制，

6. vue页面有滚动的情况最好使用scroll-view的区域滚动+uni-list组件

7. 有横向滚动最好使用uni提供的`新闻模板`,swiper+scrollview容易引发性能问题

8. 减少组件数量 + 节点嵌套层级

   * 深节点嵌套 = 更好内存 + 遍历更深、更慢

9. 避免视图层和逻辑层频繁通信

10. scroll-view相关优化（抛砖引玉）

    * 合理使用scrll事件监听 = 频繁想视图层发送数据
    * 

11. 能用css最的事（动画）就尽量不用css

12. 跟手动作

    app：renderjs

    小程序：web-view组件

## 3、第一屏优化

初始化时，大量的数据、组件、图片、通讯，在同一刻爆发 = 卡顿、掉帧

解决方式：分批渲染，延迟200ms再进行复杂组件渲染，分批进行组件通讯，以此减少一次性渲染节点数量

app端：动画掉帧就考虑用其他方式，详见文档

app-nvue和h5支持页面预载：uni.preloadpage

## 4、优化背景闪白

如果新页面进入时背景闪白

1. 页面背景是深色，有动画或者其他有经历背景变化，就会导致背景闪白

2. 原因：webview背景生效太慢 -> 将样式卸载app.vue中，这是全局样式，可以加快渲染速度，原因是，渲染顺序是先app>page

3. app在pages.json中配置页面原生背景色

   ```json
   "style":{
     "aapp-plus:{
     	"background":"#00000"
   }
   }
   ```

   

## 5、使用nvue代替vue

简介：

1. app端，首页为nvue页面，并设置`FAST启动模式`此时app启动更快
2. app设置为存nvue项目（manifest里设置app-plus下的randerer:'native'）这种配置最快，因为直接砍掉webview渲染模块 

## 6、优化包体积

不必关心